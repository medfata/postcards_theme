<div class="root">
  <div class="builder">
    <div class="header">
      <div class="box-cart">
        <div class="box-cart-header">
          <h2 class="text-center font-heading  heading-standard heading-style break-words none">
            Build Your Own Bundle
          </h2>
          <p>Select your -- travel candles.</p>
        </div>
        <div class="box-cart-content">
          <div class="box-sizer">
            <div class="radio-group">
              <button class="radio-btn is-active">
                <span class="radio-btn-label">2-Pack</span>
                <img
                  class="radio-btn-icon"
                  src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjZweCIgaGVpZ2h0PSIyNnB4IiB2aWV3Qm94PSIwIDAgMjYgMjYiIHZlcnNpb249IjEuMSIgc3R5bGU9ImNvbG9yOiBibGFjayAhaW1wb3J0YW50OyI+CiAgICA8dGl0bGU+R3JvdXAgNDwvdGl0bGU+CiAgICA8ZyBpZD0iV2lyZWZyYW1lcyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkJ1aWxkLWEtQm94LS0tRGVza3RvcCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk0My4wMDAwMDAsIC01MzAuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC00IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5NDMuMDAwMDAwLCA1MzAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsIiBzdHJva2U9IiNDMkMyQzIiIGN4PSIxMyIgY3k9IjEzIiByPSIxMi41Ii8+CiAgICAgICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsIiBmaWxsPSJibGFjayIgY3g9IjEzIiBjeT0iMTMiIHI9IjgiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"
                >
                <span class="radio-btn-price"><span>$52</span></span>
              </button>
              <button class="radio-btn">
                <span class="radio-btn-label">4-Pack</span>
                <img
                  class="radio-btn-icon"
                  src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjZweCIgaGVpZ2h0PSIyNnB4IiB2aWV3Qm94PSIwIDAgMjYgMjYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+T3ZhbCBDb3B5IDI8L3RpdGxlPgogICAgPGcgaWQ9IldpcmVmcmFtZXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJCdWlsZC1hLUJveC0tLURlc2t0b3AiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC05NDMuMDAwMDAwLCAtNjA3LjAwMDAwMCkiIHN0cm9rZT0iI0MyQzJDMiI+CiAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtQ29weS0yIiBjeD0iOTU2IiBjeT0iNjIwIiByPSIxMi41Ij48L2NpcmNsZT4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="
                >
                <div class="save-tag">SAVE 7%</div>
                <span class="radio-btn-price"><strike>$104</strike> <span>$96</span></span>
              </button>
              <button class="radio-btn">
                <span class="radio-btn-label">6-Pack</span>
                <img
                  class="radio-btn-icon"
                  src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjZweCIgaGVpZ2h0PSIyNnB4IiB2aWV3Qm94PSIwIDAgMjYgMjYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+T3ZhbCBDb3B5IDI8L3RpdGxlPgogICAgPGcgaWQ9IldpcmVmcmFtZXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJCdWlsZC1hLUJveC0tLURlc2t0b3AiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC05NDMuMDAwMDAwLCAtNjA3LjAwMDAwMCkiIHN0cm9rZT0iI0MyQzJDMiI+CiAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtQ29weS0yIiBjeD0iOTU2IiBjeT0iNjIwIiByPSIxMi41Ij48L2NpcmNsZT4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="
                >
                <div class="save-tag">SAVE 15%</div>
                <span class="radio-btn-price"><strike>$156</strike> <span>$132</span></span>
              </button>
              <button class="radio-btn">
                <span class="radio-btn-label">8-Pack</span>
                <img
                  class="radio-btn-icon"
                  src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjZweCIgaGVpZ2h0PSIyNnB4IiB2aWV3Qm94PSIwIDAgMjYgMjYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+T3ZhbCBDb3B5IDI8L3RpdGxlPgogICAgPGcgaWQ9IldpcmVmcmFtZXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJCdWlsZC1hLUJveC0tLURlc2t0b3AiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC05NDMuMDAwMDAwLCAtNjA3LjAwMDAwMCkiIHN0cm9rZT0iI0MyQzJDMiI+CiAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtQ29weS0yIiBjeD0iOTU2IiBjeT0iNjIwIiByPSIxMi41Ij48L2NpcmNsZT4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="
                >
                <div class="save-tag">SAVE 25%</div>
                <span class="radio-btn-price"><strike>$208</strike> <span>$152</span></span>
              </button>
            </div>
          </div>
          <div style="margin-top:1rem; margin-bottom:1rem">
          <div class="disktop-box"> 

          </div>
          </div>
          <button id="bundler-disktop-addCart" class="btn btn-solid box-cart-btn">Pick -- more candles</button>
        </div>
      </div>
    </div>
    <div class="products">
      {% comment %}Try different approaches to find the collection{% endcomment %}
      
      {% comment %}First, try by ID as string{% endcomment %}
      {% assign target_collection = collections["630584705297"] %}
      
      {% comment %}If that doesn't work, try with handle 'bundle-products'{% endcomment %}
      {% if target_collection == blank %}
        {% assign target_collection = collections.bundle-products %}
      {% endif %}
      
      {% comment %}If that doesn't work, try scanning all collections{% endcomment %}
      {% if target_collection == blank %}
        {% for collection in collections %}
          {% if collection.id == 630584705297 or collection.handle contains 'bundle' %}
            {% assign target_collection = collection %}
            {% break %}
          {% endif %}
        {% endfor %}
      {% endif %}
      
      {% comment %}Fallback to 'all' collection{% endcomment %}
      {% if target_collection == blank %}
        {% assign target_collection = collections.all %}
      {% endif %}
      
      {% for product in target_collection.products %}
        {% assign titleLastPart = product.title | split: ' ' | last | downcase %}
        {%- if product
          and product != empty
          and product.type != 'bundler'
          and product.title != 'Melting Protection'
          and titleLastPart != 'pack'
        -%}
          <div class="product" data-product="{{ product | json | escape }}" id="{{ product.id }}">
            <div class="product-media-object relative {% unless display_on_card %}{% if settings.media_shadow_direction contains 'top' %}pt-media-shadow{% else %}pb-media-shadow{% endif %}{% endunless %}">
              {% if product.featured_media %}
                {%-
                  render 'product-tile-media-image',
                  media: product.featured_media,
                -%}
              {% else %}
                <div class="aspect-square bg-scheme-text/10 flex items-center justify-center">
                  <span class="text-sm text-scheme-text">{{ product.title | truncate: 1, "" }}</span>
                </div>
              {% endif %}
            </div>
            <h3 class="product-title">{{ product.title | escape }}</h3>
            {%- if settings.product_tiles_show_vendor -%}
              <p class="product-vendor">{{ product.vendor }}</p>
            {%- endif -%}
            <p></p>
            <button class="product-btn">Add +</button>
          </div>
        {%- endif -%}
      {% endfor %}
    </div>
    <div class="footer">
      <div class="box"></div>
      <button id="add-bundler-to-cart" class="simple-btn btn-solid box-cart-btn" disabled="">
        PICK -- MORE CANDLES
      </button>
    </div>
  </div>
  <div class=""></div>
</div>

<!-- Hidden form for submitting bundle to cart -->
<div class="hidden">
  {% form 'product', id: 'bundler-cart-form', data-product-form: '' %}
    <input type="hidden" id="bundler-variant-id" name="id" value="">
    <input type="hidden" name="form_type" value="product">
    <input type="hidden" name="utf8" value="âœ“">
    <input type="hidden" name="quantity" value="1">
    <input type="hidden" name="sections" value="cart-items,cart-footer,cart-item-count,cart-live-region">
    <input type="hidden" name="sections_url" value="{{ request.path }}">
  {% endform %}
</div>

{% schema %}
{
  "name": "t:sections.pages__bundler.name",
  "settings": [
    {
      "type": "checkbox",
      "id": "display_on_card",
      "label": "t:common.settings.display_on_card.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:common.settings.header_color"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "label": "t:common.settings.color_scheme.label",
      "options": [
        {
          "value": "primary",
          "label": "t:common.options.primary.label"
        },
        {
          "value": "secondary",
          "label": "t:common.options.secondary.label"
        },
        {
          "value": "tertiary",
          "label": "t:common.options.tertiary.label"
        },
        {
          "value": "quaternary",
          "label": "t:common.options.quaternary.label"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "use_gradient_background",
      "label": "t:common.settings.use_gradient_background.label"
    }
  ],
  "blocks": [
    {
      "type": "background_pattern",
      "name": "t:common.blocks.background_pattern.name",
      "settings": [
        {
          "type": "select",
          "id": "type",
          "label": "t:common.blocks.background_pattern.settings.type.label",
          "options": [
            {
              "value": "diagonal_lines",
              "label": "t:common.options.diagonal_lines.label",
              "group": "Lines"
            },
            {
              "value": "grid",
              "label": "t:common.options.grid_lines.label",
              "group": "Lines"
            },
            {
              "value": "grid_with_diagonal_lines",
              "label": "t:common.options.grid_with_diagonal_lines.label",
              "group": "Lines"
            },
            {
              "value": "crosshatch",
              "label": "t:common.options.crosshatch.label",
              "group": "Lines"
            },
            {
              "value": "checkerboard",
              "label": "t:common.options.checkerboard.label",
              "group": "Lines"
            },
            {
              "value": "zig_zag",
              "label": "t:common.options.zig_zag.label",
              "group": "Lines"
            },
            {
              "value": "waves",
              "label": "t:common.options.waves.label",
              "group": "Lines"
            },
            {
              "value": "half_square_triangle",
              "label": "t:common.options.half-square_triangle.label",
              "group": "Shapes"
            },
            {
              "value": "dots",
              "label": "t:common.options.dots.label",
              "group": "Shapes"
            },
            {
              "value": "triangle",
              "label": "t:common.options.triangles.label",
              "group": "Shapes"
            },
            {
              "value": "polka_dot",
              "label": "t:common.options.polka_dot.label",
              "group": "Shapes"
            },
            {
              "value": "polka_dot_triangles",
              "label": "t:common.options.polka_dot_triangles.label",
              "group": "Shapes"
            },
            {
              "value": "plus",
              "label": "t:common.options.plus.label",
              "group": "Shapes"
            },
            {
              "value": "cross",
              "label": "t:common.options.cross.label",
              "group": "Shapes"
            },
            {
              "value": "squares",
              "label": "t:common.options.squares.label",
              "group": "Shapes"
            },
            {
              "value": "diamonds",
              "label": "t:common.options.diamonds.label",
              "group": "Shapes"
            },
            {
              "value": "vertical_stripes",
              "label": "t:common.options.vertical_stripes.label",
              "group": "Stripes"
            },
            {
              "value": "horizontal_stripes",
              "label": "t:common.blocks.background_pattern.settings.type.options.horizontal_stripes.label",
              "group": "Stripes"
            },
            {
              "value": "diagonal_stripes",
              "label": "t:common.options.diagonal_stripes.label",
              "group": "Stripes"
            },
            {
              "value": "sprinkles",
              "label": "t:common.blocks.background_pattern.settings.type.options.sprinkles.label",
              "group": "Miscellaneous"
            },
            {
              "value": "bubbles",
              "label": "t:common.blocks.background_pattern.settings.type.options.bubbles.label",
              "group": "Miscellaneous"
            },
            {
              "value": "squiggle",
              "label": "t:common.options.squiggle.label",
              "group": "Miscellaneous"
            },
            {
              "value": "windmill",
              "label": "t:common.options.windmill.label",
              "group": "Miscellaneous"
            },
            {
              "value": "8bit",
              "label": "t:common.options.8bit.label",
              "group": "Miscellaneous"
            },
            {
              "value": "origami",
              "label": "t:common.options.origami.label",
              "group": "Miscellaneous"
            },
            {
              "value": "3d_cube",
              "label": "t:common.blocks.background_pattern.settings.type.options.3d_cube.label",
              "group": "Miscellaneous"
            }
          ]
        },
        {
          "type": "select",
          "id": "color",
          "label": "t:common.blocks.background_pattern.settings.color.label",
          "default": "text",
          "options": [
            {
              "value": "text",
              "label": "t:common.options.text.label"
            },
            {
              "value": "accent-1",
              "label": "t:common.options.accent_1.label"
            },
            {
              "value": "accent-2",
              "label": "t:common.options.accent_2.label"
            },
            {
              "value": "card",
              "label": "t:common.options.card.label"
            },
            {
              "value": "background",
              "label": "t:common.options.background.label"
            },
            {
              "value": "gradient",
              "label": "t:common.options.gradient.label"
            }
          ]
        },
        {
          "type": "range",
          "id": "size",
          "min": 6,
          "max": 600,
          "unit": "px",
          "label": "t:common.blocks.background_pattern.settings.size.label",
          "step": 6,
          "default": 24
        },
        {
          "type": "range",
          "id": "opacity",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "t:common.settings.opacity.label",
          "default": 100
        },
        {
          "type": "header",
          "content": "t:common.settings.header_animation"
        },
        {
          "type": "checkbox",
          "id": "enable_parallax",
          "label": "t:common.blocks.background_pattern.settings.enable_parallax.label",
          "default": false,
          "info": "t:common.blocks.background_pattern.settings.enable_parallax.info"
        },
        {
          "type": "range",
          "id": "parallax_speed",
          "min": 1,
          "max": 10,
          "step": 1,
          "label": "t:common.settings.parallax_speed.label",
          "default": 3
        }
      ]
    },
    {
      "type": "background_shape",
      "name": "t:common.blocks.background_shape.name",
      "settings": [
        {
          "type": "select",
          "id": "shape",
          "label": "t:common.blocks.background_shape.settings.shape.label",
          "default": "square",
          "options": [
            {
              "value": "square",
              "label": "t:common.blocks.background_shape.settings.shape.options.square.label",
              "group": "Basic"
            },
            {
              "value": "circle",
              "label": "t:common.blocks.background_shape.settings.shape.options.circle.label",
              "group": "Basic"
            },
            {
              "value": "oval",
              "label": "t:common.blocks.background_shape.settings.shape.options.oval.label",
              "group": "Basic"
            },
            {
              "value": "triangle",
              "label": "t:common.blocks.background_shape.settings.shape.options.triangle.label",
              "group": "Basic"
            },
            {
              "value": "parallelogram",
              "label": "t:common.blocks.background_shape.settings.shape.options.parallelogram.label",
              "group": "Basic"
            },
            {
              "value": "pentagon",
              "label": "t:common.options.pentagon.label",
              "group": "Polygons"
            },
            {
              "value": "hexagon",
              "label": "t:common.options.hexagon.label",
              "group": "Polygons"
            },
            {
              "value": "heptagon",
              "label": "t:common.options.heptagon.label",
              "group": "Polygons"
            },
            {
              "value": "octagon",
              "label": "t:common.options.octagon.label",
              "group": "Polygons"
            },
            {
              "value": "star_1",
              "label": "t:common.options.star_1.label",
              "group": "Circular"
            },
            {
              "value": "star_2",
              "label": "t:common.options.star_2.label",
              "group": "Circular"
            },
            {
              "value": "star_3",
              "label": "t:common.options.star_3.label",
              "group": "Circular"
            },
            {
              "value": "star_4",
              "label": "t:common.options.star_4.label",
              "group": "Circular"
            },
            {
              "value": "scalloped_circle_1",
              "label": "t:common.options.scalloped_circle_1.label",
              "group": "Circular"
            },
            {
              "value": "scalloped_circle_2",
              "label": "t:common.options.scalloped_circle_2.label",
              "group": "Circular"
            },
            {
              "value": "scalloped_circle_3",
              "label": "t:common.options.scalloped_circle_3.label",
              "group": "Circular"
            },
            {
              "value": "scalloped_circle_4",
              "label": "t:common.options.scalloped_circle_4.label",
              "group": "Circular"
            },
            {
              "value": "blob",
              "label": "t:common.options.blob.label",
              "group": "Miscellaneous"
            }
          ]
        },
        {
          "type": "range",
          "id": "blob_type",
          "min": 1,
          "max": 10,
          "step": 1,
          "label": "t:common.blocks.background_shape.settings.blob_type.label",
          "default": 1,
          "info": "t:common.blocks.background_shape.settings.blob_type.info"
        },
        {
          "type": "range",
          "id": "size",
          "min": 25,
          "max": 300,
          "step": 5,
          "label": "t:common.blocks.background_shape.settings.size.label",
          "default": 100
        },
        {
          "type": "range",
          "id": "opacity",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "t:common.settings.opacity.label",
          "default": 100
        },
        {
          "type": "range",
          "id": "blur",
          "min": 0,
          "max": 500,
          "step": 5,
          "unit": "px",
          "label": "t:common.blocks.background_shape.settings.blur.label",
          "default": 0
        },
        {
          "type": "header",
          "content": "t:common.settings.header_position"
        },
        {
          "type": "range",
          "id": "horizontal_position",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "t:common.blocks.background_shape.settings.horizontal_position.label",
          "default": 50
        },
        {
          "type": "range",
          "id": "vertical_position",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "t:common.blocks.background_shape.settings.vertical_position.label",
          "default": 50
        },
        {
          "type": "range",
          "id": "rotate",
          "min": -90,
          "max": 90,
          "step": 2,
          "unit": "deg",
          "label": "t:common.settings.rotate.label",
          "default": 0
        },
        {
          "type": "header",
          "content": "t:common.settings.header_animation"
        },
        {
          "type": "checkbox",
          "id": "enable_parallax",
          "label": "t:common.blocks.background_shape.settings.enable_parallax.label",
          "default": false,
          "info": "t:common.blocks.background_shape.settings.enable_parallax.info"
        },
        {
          "type": "range",
          "id": "parallax_speed",
          "min": 1,
          "max": 10,
          "step": 1,
          "label": "t:common.settings.parallax_speed.label",
          "default": 3
        },
        {
          "type": "header",
          "content": "t:common.settings.header_color"
        },
        {
          "type": "select",
          "id": "color",
          "label": "t:common.blocks.background_shape.settings.color.label",
          "default": "accent-1",
          "options": [
            {
              "value": "text",
              "label": "t:common.options.text.label"
            },
            {
              "value": "accent-1",
              "label": "t:common.options.accent_1.label"
            },
            {
              "value": "accent-2",
              "label": "t:common.options.accent_2.label"
            },
            {
              "value": "card",
              "label": "t:common.options.card.label"
            },
            {
              "value": "background",
              "label": "t:common.options.background.label"
            },
            {
              "value": "gradient",
              "label": "t:common.options.gradient.label"
            }
          ]
        },
        {
          "type": "select",
          "id": "color_scheme",
          "label": "t:common.settings.color_scheme.label",
          "default": "same_as_section",
          "options": [
            {
              "value": "same_as_section",
              "label": "t:common.options.same_as_section.label"
            },
            {
              "value": "primary",
              "label": "t:common.options.primary.label"
            },
            {
              "value": "secondary",
              "label": "t:common.options.secondary.label"
            },
            {
              "value": "tertiary",
              "label": "t:common.options.tertiary.label"
            },
            {
              "value": "quaternary",
              "label": "t:common.options.quaternary.label"
            }
          ]
        }
      ]
    },
    {
      "name": "t:common.blocks.sticker.name",
      "type": "sticker",
      "settings": [
        {
          "type": "textarea",
          "id": "text",
          "label": "t:common.blocks.sticker.settings.text.label",
          "default": "Sticker"
        },
        {
          "type": "select",
          "id": "shape",
          "label": "t:common.blocks.sticker.settings.shape.label",
          "options": [
            {
              "value": "fit_to_text",
              "label": "t:common.blocks.sticker.settings.shape.options.fit_to_text.label"
            },
            {
              "value": "circle",
              "label": "t:common.options.circle.label",
              "group": "Circular"
            },
            {
              "value": "star_1",
              "label": "t:common.options.star_1.label",
              "group": "Circular"
            },
            {
              "value": "star_2",
              "label": "t:common.options.star_2.label",
              "group": "Circular"
            },
            {
              "value": "star_3",
              "label": "t:common.options.star_3.label",
              "group": "Circular"
            },
            {
              "value": "star_4",
              "label": "t:common.options.star_4.label",
              "group": "Circular"
            },
            {
              "value": "scalloped_circle_1",
              "label": "t:common.options.scalloped_circle_1.label",
              "group": "Circular"
            },
            {
              "value": "scalloped_circle_2",
              "label": "t:common.options.scalloped_circle_2.label",
              "group": "Circular"
            },
            {
              "value": "scalloped_circle_3",
              "label": "t:common.options.scalloped_circle_3.label",
              "group": "Circular"
            },
            {
              "value": "scalloped_circle_4",
              "label": "t:common.options.scalloped_circle_4.label",
              "group": "Circular"
            },
            {
              "value": "parallelogram",
              "label": "t:common.options.parallelogram.label",
              "group": "Square"
            },
            {
              "value": "scalloped_square",
              "label": "t:common.options.scalloped.label",
              "group": "Square"
            },
            {
              "value": "leaf",
              "label": "t:common.options.leaf.label",
              "group": "Square"
            },
            {
              "value": "clipped_square",
              "label": "t:common.options.clipped.label",
              "group": "Square"
            },
            {
              "value": "convex_square",
              "label": "t:common.options.convex.label",
              "group": "Square"
            },
            {
              "value": "twisted_square",
              "label": "t:common.options.twisted.label",
              "group": "Square"
            },
            {
              "value": "trapeze",
              "label": "t:common.options.trapeze.label",
              "group": "Square"
            },
            {
              "value": "ellipse",
              "label": "t:common.options.ellipse.label",
              "group": "Wide"
            },
            {
              "value": "diamond_wide",
              "label": "t:common.options.diamond.label",
              "group": "Wide"
            },
            {
              "value": "rounded_diamond_wide",
              "label": "t:common.options.rounded_diamond.label",
              "group": "Wide"
            },
            {
              "value": "triangle_wide",
              "label": "t:common.options.triangle.label",
              "group": "Wide"
            },
            {
              "value": "hexagon_wide",
              "label": "t:common.options.hexagon.label",
              "group": "Wide"
            },
            {
              "value": "rounded_hexagon",
              "label": "t:common.options.rounded_hexagon.label",
              "group": "Wide"
            },
            {
              "value": "uneven_star_wide",
              "label": "t:common.options.uneven_star.label",
              "group": "Wide"
            },
            {
              "value": "star_wide",
              "label": "t:common.options.star.label",
              "group": "Wide"
            },
            {
              "value": "semicircle",
              "label": "t:common.options.semicircle.label",
              "group": "Wide"
            },
            {
              "value": "eye",
              "label": "t:common.options.eye.label",
              "group": "Wide"
            },
            {
              "value": "parallelogram_wide",
              "label": "t:common.options.parallelogram.label",
              "group": "Wide"
            },
            {
              "value": "ribbon",
              "label": "t:common.options.ribbon.label",
              "group": "Wide"
            },
            {
              "value": "ticket_stub",
              "label": "t:common.options.ticket_stub.label",
              "group": "Wide"
            },
            {
              "value": "wave_ribbon",
              "label": "t:common.options.wave_ribbon.label",
              "group": "Wide"
            },
            {
              "value": "zig_zag_ribbon",
              "label": "t:common.options.zig_zag_ribbon.label",
              "group": "Wide"
            }
          ],
          "default": "star_1"
        },
        {
          "type": "range",
          "id": "width",
          "min": 100,
          "max": 300,
          "step": 10,
          "unit": "px",
          "label": "t:common.blocks.sticker.settings.width.label",
          "default": 150
        },
        {
          "type": "select",
          "id": "sticker_font_size",
          "label": "t:common.settings.sticker_font_size.label",
          "options": [
            {
              "value": "1rem",
              "label": "t:common.options.extra_small.label"
            },
            {
              "value": "1.25rem",
              "label": "t:common.options.small.label"
            },
            {
              "value": "1.563rem",
              "label": "t:common.options.medium.label"
            },
            {
              "value": "1.953rem",
              "label": "t:common.options.large.label"
            },
            {
              "value": "2.441rem",
              "label": "t:common.options.extra_large.label"
            }
          ],
          "default": "1.563rem",
          "info": "t:common.settings.sticker_font_size.info"
        },
        {
          "type": "header",
          "content": "t:common.settings.header_custom_image"
        },
        {
          "type": "paragraph",
          "content": "t:common.blocks.sticker.settings.paragraph_using_an_image"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "t:common.settings.image.label"
        },
        {
          "type": "checkbox",
          "id": "half_image_width_on_mobile",
          "label": "t:common.blocks.sticker.settings.half_image_width_on_mobile.label",
          "default": true
        },
        {
          "type": "header",
          "content": "t:common.settings.header_position"
        },
        {
          "type": "range",
          "id": "horizontal_position",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "t:common.blocks.sticker.settings.horizontal_position.label",
          "default": 80
        },
        {
          "type": "range",
          "id": "vertical_position",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "t:common.blocks.sticker.settings.vertical_position.label",
          "default": 80
        },
        {
          "type": "range",
          "id": "rotate",
          "min": -90,
          "max": 90,
          "step": 2,
          "unit": "deg",
          "label": "t:common.settings.rotate.label",
          "default": 0
        },
        {
          "type": "header",
          "content": "t:common.settings.header_layout"
        },
        {
          "type": "checkbox",
          "id": "show_sticker_on_mobile",
          "label": "t:common.blocks.sticker.settings.show_sticker_on_mobile.label",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_sticker_on_desktop",
          "label": "t:common.blocks.sticker.settings.show_sticker_on_desktop.label",
          "default": true
        },
        {
          "type": "header",
          "content": "t:common.settings.header_animation"
        },
        {
          "type": "select",
          "id": "rotation_animation",
          "label": "t:common.blocks.sticker.settings.rotation_animation.label",
          "options": [
            {
              "value": "none",
              "label": "t:common.blocks.sticker.settings.rotation_animation.options.no_rotation.label"
            },
            {
              "value": "constantly_rotate",
              "label": "t:common.blocks.sticker.settings.rotation_animation.options.constantly_rotate.label"
            },
            {
              "value": "rotate_when_scrolling",
              "label": "t:common.blocks.sticker.settings.rotation_animation.options.rotate_only_when_page_is_scrolling.label"
            }
          ],
          "default": "none"
        },
        {
          "type": "checkbox",
          "id": "enable_parallax",
          "label": "t:common.blocks.sticker.settings.enable_parallax.label",
          "default": false,
          "info": "t:common.blocks.sticker.settings.enable_parallax.info"
        },
        {
          "type": "range",
          "id": "parallax_speed",
          "min": 1,
          "max": 10,
          "step": 1,
          "label": "t:common.settings.parallax_speed.label",
          "default": 3
        },
        {
          "type": "header",
          "content": "t:common.settings.header_color"
        },
        {
          "type": "select",
          "id": "color",
          "label": "t:common.settings.color.label",
          "default": "bg-scheme-accent-1 text-scheme-accent-1-overlay",
          "options": [
            {
              "value": "bg-scheme-text text-scheme-text-overlay",
              "label": "t:common.options.text.label"
            },
            {
              "value": "bg-scheme-accent-1 text-scheme-accent-1-overlay",
              "label": "t:common.options.accent_1.label"
            },
            {
              "value": "bg-scheme-accent-2 text-scheme-accent-2-overlay",
              "label": "t:common.options.accent_2.label"
            },
            {
              "value": "bg-scheme-card text-scheme-text",
              "label": "t:common.options.card.label"
            },
            {
              "value": "bg-scheme-background text-scheme-text",
              "label": "t:common.options.background.label"
            },
            {
              "value": "bg-scheme-gradient text-scheme-text",
              "label": "t:common.options.gradient.label"
            }
          ]
        },
        {
          "type": "select",
          "id": "color_scheme",
          "label": "t:common.settings.color_scheme.label",
          "default": "same_as_section",
          "options": [
            {
              "value": "same_as_section",
              "label": "t:common.options.same_as_section.label"
            },
            {
              "value": "primary",
              "label": "t:common.options.primary.label"
            },
            {
              "value": "secondary",
              "label": "t:common.options.secondary.label"
            },
            {
              "value": "tertiary",
              "label": "t:common.options.tertiary.label"
            },
            {
              "value": "quaternary",
              "label": "t:common.options.quaternary.label"
            }
          ]
        }
      ]
    },
    {
      "name": "t:common.blocks.shape_divider.name",
      "type": "shape_divider",
      "limit": 2,
      "settings": [
        {
          "type": "radio",
          "label": "t:common.blocks.shape_divider.settings.target_section.label",
          "id": "target_section",
          "default": "above",
          "options": [
            {
              "value": "above",
              "label": "t:common.blocks.shape_divider.settings.target_section.options.section_above.label"
            },
            {
              "value": "below",
              "label": "t:common.blocks.shape_divider.settings.target_section.options.section_below.label"
            }
          ],
          "info": "t:common.blocks.shape_divider.settings.target_section.info"
        },
        {
          "type": "select",
          "label": "t:common.blocks.shape_divider.settings.target_section_color_scheme.label",
          "id": "target_section_color_scheme",
          "default": "secondary",
          "options": [
            {
              "value": "primary",
              "label": "t:common.options.primary.label"
            },
            {
              "value": "secondary",
              "label": "t:common.options.secondary.label"
            },
            {
              "value": "tertiary",
              "label": "t:common.options.tertiary.label"
            },
            {
              "value": "quaternary",
              "label": "t:common.options.quaternary.label"
            }
          ],
          "info": "t:common.blocks.shape_divider.settings.target_section_color_scheme.info"
        },
        {
          "type": "select",
          "label": "t:common.blocks.shape_divider.settings.style.label",
          "id": "style",
          "default": "large-waves_1200x84",
          "options": [
            {
              "value": "large-waves_1200x84",
              "label": "t:common.blocks.shape_divider.settings.style.options.large_waves.label",
              "group": "Symmetrical"
            },
            {
              "value": "medium-waves_1200x43",
              "label": "t:common.blocks.shape_divider.settings.style.options.medium_waves.label",
              "group": "Symmetrical"
            },
            {
              "value": "small-waves_1200x20",
              "label": "t:common.blocks.shape_divider.settings.style.options.small_waves.label",
              "group": "Symmetrical"
            },
            {
              "value": "large-zig-zag_1200x65",
              "label": "t:common.blocks.shape_divider.settings.style.options.large_zig_zag.label",
              "group": "Symmetrical"
            },
            {
              "value": "medium-zig-zag_1200x37",
              "label": "t:common.blocks.shape_divider.settings.style.options.medium_zig_zag.label",
              "group": "Symmetrical"
            },
            {
              "value": "small-zig-zag_1200x21",
              "label": "t:common.blocks.shape_divider.settings.style.options.small_zig_zag.label",
              "group": "Symmetrical"
            },
            {
              "value": "waves-1-asymmetrical_1440x261",
              "label": "t:common.blocks.shape_divider.settings.style.options.waves_1.label",
              "group": "Asymmetrical"
            },
            {
              "value": "waves-2-asymmetrical_1440x330",
              "label": "t:common.blocks.shape_divider.settings.style.options.waves_2.label",
              "group": "Asymmetrical"
            },
            {
              "value": "tilt-1-asymmetrical_1440x101",
              "label": "t:common.blocks.shape_divider.settings.style.options.tilt_1.label",
              "group": "Asymmetrical"
            },
            {
              "value": "tilt-2-asymmetrical_1440x293",
              "label": "t:common.blocks.shape_divider.settings.style.options.tilt_2.label",
              "group": "Asymmetrical"
            },
            {
              "value": "mountains-1-asymmetrical_1440x293",
              "label": "t:common.blocks.shape_divider.settings.style.options.mountains_1.label",
              "group": "Asymmetrical"
            },
            {
              "value": "mountains-2-asymmetrical_1440x325",
              "label": "t:common.blocks.shape_divider.settings.style.options.mountains_2.label",
              "group": "Asymmetrical"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "flip_horizontal",
          "label": "t:common.blocks.shape_divider.settings.flip_horizontal.label"
        },
        {
          "type": "header",
          "content": "t:common.settings.header_animation"
        },
        {
          "type": "checkbox",
          "id": "enable_animation",
          "label": "t:common.blocks.shape_divider.settings.enable_animation.label",
          "info": "t:common.blocks.shape_divider.settings.enable_animation.info"
        },
        {
          "type": "radio",
          "id": "animation_direction",
          "label": "t:common.blocks.shape_divider.settings.animation_direction.label",
          "options": [
            {
              "value": "",
              "label": "t:common.options.right_to_left.label"
            },
            {
              "value": "reverse",
              "label": "t:common.options.left_to_right.label"
            }
          ],
          "default": ""
        }
      ]
    }
  ]
}
{% endschema %}

{% stylesheet %}
    #bundler-disktop-addCart{
      display:none;  
    }
    .box-cart-content .disktop-box{ 
      display:none; 
    }
    
    .box-cart-header h2{
      font-size: 1.6rem; 
    }
    .header{
       width: calc(100% + 1.2rem); 
      margin-left: -0.6rem;
    }
    .border-b-section{
      border:none; 
    }
    .footer .box{
      justify-content: center;
      margin: -1rem 0 1.2rem;
      width: 100%;
      display: flex;
      flex-wrap: wrap;
    }
    .footer .box-product {
      width: auto;
      margin: 0;
      position: relative;
      border: 1px solid;
      margin-right: .3rem;
      margin-top: .6rem;
    }
    .box-product .btn-remove {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translate(-50%,20%);
      width: 1rem;
      height: 1rem;
      margin-bottom: -6px;
    }
    .footer .box-product-img {
          max-width: 2.7rem;
    }
    .box-cart-header{
          margin-bottom: 10px;
    }
    .footer {
        position: fixed;
        z-index: 20; 
        width: 100%;
        box-sizing: border-box;
        bottom: 0;
        left: 0;
        padding: 1.25rem;
        background: hsl(0deg 100% 98.32% / 90%);
    }
    .footer .box-cart-btn {
        display: block;
        margin: 0;
        border: 2px solid black;
        padding: 0.5rem;
    }
    .box-cart-btn {
        display: none;
        margin-bottom: 1rem;
        width: 100%;
    }
    .btn-solid {
      background: #ddeaf3;
      color: black;
      height: 100%;
    }
    .builder{
      padding-top: 0.5rem;
      text-align: center;
      max-width: 1800px;
      margin: 0 auto;
      padding: 0 1rem;
      margin-top: 1rem;
    }
    .box-cart {
        top: 0;
        position: -webkit-sticky;
        position: sticky;
        display: flex;
        flex-direction: column;
    }
    .box-cart-title {
      font-size: 2rem;
    }
    .box-cart-titel p {
      font-size: 1rem;
    }
    .packaging-label {
        font-family: National;
        font-size: 1.25rem;
        text-transform: uppercase;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .packaging-btns {
        display: flex;
        margin-bottom: .5rem;
    }
    .radio-group {
        display: flex;
        flex-direction: column;
        border: 1px solid #394053;
        overflow: hidden;
        border-radius: 2px;
        max-width: 100%;
        margin: 0 auto;
    }
    .radio-btn {
      display: flex;
      align-items: center;
      border: none;
      padding: 0.8rem 0.6rem;
      background: none;
      font-size: 1rem;
      color: #394053;
      background-color: #Fffcf3;
      position: relative;
      justify-content: space-between;
      text-align: left;
      cursor: pointer;
    }
    .radio-btn-label {
      font-size: 1.2rem;
      font-weight: 600;
      color: #483f36;
      white-space: nowrap;
      margin-right: 1rem;
    }
    .radio-btn.is-active {
      color: #484646;
      background: #fdf2bd;
    }
    .radio-btn-price {
      display: flex;
      align-items: center;
      margin-left: auto;
      font-size: 1.2rem;
      color: #483f36;
      font-weight: 600;
    }
    .radio-btn-price strike {
      font-size: 0.9rem;
      color: #a39f9d;
      margin-right: 0.3rem;
    }
    .radio-btn-icon {
      background-color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      margin: 0 0.5rem;
    }
    .radio-group button:nth-child(-n+3) {
      border-bottom: 1px solid #394053;
    }
    .save-tag {
      position: absolute;
      right: 100px;
      background-color: #fffcce;
      border: 1px dashed #483f36;
      padding: 0.2rem 0.8rem;
      font-size: 0.75rem;
      font-weight: bold;
      transform: rotate(-2deg);
      color: #483f36;
      white-space: nowrap;
    }
    .radio-btn:nth-child(4) .save-tag {
      background-color: #ef4136;
      color: white;
    }

    .products {
      display: flex;
      flex-wrap: wrap;
      justify-content: center; 
      width: calc(100% + 2rem);
      margin: 2rem -1rem -1rem;
      padding-bottom: 12rem; 
      gap:0.4rem;
    }
    .products .product {
      cursor: pointer;
    }
    .product {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 10rem;
      margin-bottom: 1rem;
      box-sizing: border-box;
    }
    .product-img {
      max-width: 116px;
      margin-bottom: 1.5rem;
    }
    .product-title {
      margin-top: .5rem;
      font-size: 1.3rem !important; 
    }
    .product-vendor {
      margin-top: .5rem;
      margin-bottom: 0.5rem;
      font-size: 0.9rem !important; 
    }
    .product-btn {
      margin-top: auto;
      width: 100%;
      line-height: 2.5;
      font-size: 0.8rem;
      font-weight: 500; 
      letter-spacing: 1px;
      background: #ddeaf3;
      color: #000;
      border: 1px solid;
    }
    .pack-badge{
      position: absolute;
      top: 0;
      right: 6rem;
      font-size: 0.8rem;
      border: 2px solid #ddeaf3; 
      border-top: none;
      padding: 0.2rem;
      background-color: #ddeaf3;
      letter-spacing: 0.1px;
      width: 5.5rem;
    } 
    @media (min-width: 979px){
      .box-product-img{
        max-width: 150px;
        margin-top: 15px;
        border: 2px solid black;
      }
      #bundler-disktop-addCart{
        display:inline-block;
      }
      .box-cart-content .disktop-box{
        display: flex; 
        flex-wrap:wrap;
        justify-content: space-evenly;
        gap:1rem;
        flex-wrap: wrap;
      }
      .disktop-box .box-product{
         position: relative;
      }
      .builder{
        flex-direction: row-reverse;
        display: flex;
        margin-top: 80px;
      }
      .header {
        width: 30rem;
        flex: none;
        padding:1rem;
      }
      .radio-group{
        max-width: 500px;
        margin: auto;
      }
      .radio-btn {
        padding: 0.6rem 0.8rem;
      }
      .radio-btn-label {
        font-size: 1.1rem;
      }
      .radio-btn-price {
        font-size: 1.1rem;
        font-family: "Avenir Next", sans-serif;
      }
      .radio-btn-price strike {
        font-size: 0.85rem;
        font-family: "Avenir Next", sans-serif;
      }
      .save-tag {
        padding: 0.15rem 0.6rem;
        font-size: 0.7rem;
        font-family: "Avenir Next", sans-serif;
      }
      .radio-btn-icon {
        width: 20px;
        height: 20px;
      }
      .box-cart-btn{
        max-width: 500px;
        margin: auto!important;
      }
      .products{
        width: calc(66.666% - 1.625rem);
        margin-right: 0;
      }
      .products .product{
        margin: 0 .8125rem 1rem;
        width: 250px; 
      }
      .product-title {
        font-size: 1.125rem;
      }
      .product-vendor{
        font-size: 0.8rem;
      }
      .product-btn{
        line-height: 3;
      }
      .footer {
        display: none;
      }
      .box-product .btn-remove {
        position: absolute;
        top: 0;
        left: 0;
        transform: translate(-50%,20%);
        width: 1.3rem;
        height: 1.3rem;
        margin-bottom: -6px;
      }
    }
    @media (max-width: 480px) {
      .radio-btn-label {
        font-size: 1rem;
      }
      .radio-btn-price {
        font-size: 1rem;
      }
      .radio-btn-price strike {
        font-size: 0.75rem;
      }
      .save-tag {
        padding: 0.1rem 0.5rem;
        font-size: 0.65rem;
      }
      .radio-btn-icon {
        width: 20px;
        height: 20px;
        margin: 0 0.3rem;
      }
      .radio-btn {
        padding: 0.8rem .8rem;
      }
    }
{% endstylesheet %}

{% javascript %}
  // Helper function to parse HTML
  function parseDOMFromString(string) {
    return new DOMParser().parseFromString(string, 'text/html');
  }
  
  function querySelectorInHTMLString(selector, string) {
    return parseDOMFromString(string).querySelector(selector);
  }
  
  const boxProductX = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSI+CiAgICA8dGl0bGU+Y2xvc2U8L3RpdGxlPgogICAgPGcgaWQ9IldpcmVmcmFtZXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJCdWlsZC1hLUJveC0tLURlc2t0b3AiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC05MzIuMDAwMDAwLCAtMzEyLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0iY2xvc2UiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkzMi4wMDAwMDAsIDMxMi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwiIGZpbGw9IiNFNjk4OUMiIGN4PSIxMiIgY3k9IjEyIiByPSIxMiIgc3R5bGU9IiYjMTA7ICAgIGZpbGw6ICMzOTQwNTM7JiMxMDsiLz4KICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOC4wMDAwMDAsIDguNzE0MTU1KSIgc3Ryb2tlPSIjRkZGRkZGIiBzdHJva2UtbGluZWNhcD0ic3F1YXJlIiBzdHJva2Utd2lkdGg9IjEuNSIgc3R5bGU9IiYjMTA7ICAgIHN0cm9rZTogI2ZmZmNmMzsmIzEwOyI+CiAgICAgICAgICAgICAgICAgICAgPGxpbmUgeDE9IjAuNTM5ODY5MjU0IiB5MT0iMC41NjE0NjQ5NDQiIHgyPSI2Ljk3MDEyNzQ5IiB5Mj0iNi4yNzcyNTAwNCIgaWQ9IkxpbmUtMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy43NTQ5OTgsIDMuNDE5Mzg1KSByb3RhdGUoMy4zNjY0NjEpIHRyYW5zbGF0ZSgtMy43NTQ5OTgsIC0zLjQxOTM4NSkgIi8+CiAgICAgICAgICAgICAgICAgICAgPGxpbmUgeDE9IjAuNzEzMjQwMjIzIiB5MT0iNi40NjExMTczMiIgeDI9IjYuNzk2NzU5NzgiIHkyPSIwLjM3NzU5Nzc2NSIgaWQ9IkxpbmUtMyIvPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=';
  const disktopPlaceHolder = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJMYXllcl8yIiBkYXRhLW5hbWU9IkxheWVyIDIiIHZpZXdCb3g9IjAgMCA2NjcuMzEgNjY3LjMyIiB3aWR0aD0iMTQ0cHgiIGhlaWdodD0iMTc3cHgiPgogIDxkZWZzPgogICAgPHN0eWxlPgogICAgICAuY2xzLTEgewogICAgICAgIGZpbGw6IG5vbmU7CiAgICAgICAgc3Ryb2tlOiAjM2E0MDUzOwogICAgICAgIHN0cm9rZS1taXRlcmxpbWl0OiAxMDsKICAgICAgICBzdHJva2Utd2lkdGg6IDhweDsKICAgICAgfQogICAgPC9zdHlsZT4KICA8L2RlZnM+CiAgPGcgaWQ9IkxheWVyXzEtMiIgZGF0YS1uYW1lPSJMYXllciAxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtZGFzaGFycmF5PSI0LDEwIj4KICAgIDxwYXRoIGNsYXNzPSJjbHMtMSIgZD0ibTEwNy4xNiwzMi4zM2MxMC4xLTMuNjksMTYuOTYtMTAuNDQsMTkuODUtMjAuOTYuNC0xLjQ1LjgtMi44OS44MS00LjQ0LjAxLTIuMDguODQtMi44NiwyLjk1LTIuODgsMy41Mi0uMDUsNy4wMy0uMDEsMTAuNTUtLjAxLDUuOTEsMCwxMS44MywwLDE3Ljc0LDAsMi4zLDAsMi4yMS4wNSwyLjk1LDIuMTMuNywxLjk1LDEuMSwzLjk1LDEuNTYsNS45NS44MSwzLjUzLDIuNzMsNi41NSw0Ljk0LDkuNDQsMy4xMiw0LjA4LDYuOTQsNy4yMSwxMS41OSw5LjM1LDUuMjUsMi40MiwxMC42NiwzLjQ2LDE2LjQ3LDIuNSwyLjQ1LS40MSw0LjgyLS44NSw3LjAxLTIuMDQsNC43Ny0xLjU2LDguNTctNC41NCwxMS43Ny04LjI5LDMuNjktNC4zNCw1Ljc3LTkuNDUsNi44LTE1LjAyLjA3LS4zOS4xLS43OS4xNC0xLjE4LjE3LTIuMTkuNzItMi44MiwyLjkzLTIuODMsOS41OS0uMDQsMTkuMTgtLjAzLDI4Ljc3LDAsMS44MiwwLDIuMDcuMzgsMi4zOCwyLjIxLDEuMTIsNi43NiwzLjg0LDEyLjg0LDguNDgsMTcuODQsNC4zMSw0LjY1LDkuNzMsNy44MywxNS45Nyw5LjA1LDkuMjUsMS44MSwxNy42NC0uMzEsMjUuMDEtNi4zNiwzLjU4LTIuOTQsNi4yNS02LjUzLDguMjQtMTAuNjUsMS4zNi0yLjgyLDIuMTMtNS44MSwyLjI0LTguOTYuMDgtMi4zNy44MS0zLjEzLDMuMjEtMy4xNCw5LjUxLS4wMiwxOS4wMiwwLDI4LjUzLS4wMS43MiwwLDEuNDIuMDMsMi4xLjM4Ljc4LjQxLDEuNDEuOTEuOTgsMS44Ni0uNDQsMS0uMTgsMS44NS4yNiwyLjc0LjI1LjQ5LjQ0LDEuMDMuNTUsMS41NywxLjQ0LDYuNzUsNS4xOCwxMi4wMiwxMC40NSwxNi4zMyw1LjcyLDQuNjgsMTIuMjYsNy4wMSwxOS42Miw2LjgzLDUuMzMtLjEzLDEwLjMyLTEuNjMsMTQuODUtNC41NCw1LjU1LTMuNTUsOS42OC04LjMxLDEyLjA4LTE0LjQyLjk4LTIuNDgsMS44Ni01LjA3LDEuODgtNy44NS4wMi0yLjA5Ljg0LTIuODgsMi45NS0yLjg5LDkuNjctLjAzLDE5LjM0LDAsMjkuMDEtLjAyLjc0LDAsMS40Mi4xNCwyLjA3LjQ5LTEuMDcsNy45MywyLjIsMTQuMzUsNy4yOSwxOS45NywzLjUxLDMuODcsNy41Nyw3LjE0LDEyLjU4LDguOTQsOC43NiwzLjE2LDE3LjI2LDIuNjgsMjUuNC0yLjAxLDYuNTctMy43OCwxMS4zOS05LjE1LDE0LjU0LTE2LjA2LDEuMDQtMi4yOSwxLjQzLTQuNzMsMi4wNC03LjEzLjc4LTMuMDMsMS4xOS0zLjM5LDQuMjYtMy40LDcuNzUtLjAzLDE1LjUxLS4wMywyMy4yNiwwLDMuMjMuMDEsNC4xNS43MSw0LjYzLDMuOTMuNTYsMy43OSwxLjgxLDcuMzMsMy44NCwxMC41MSw1LjQsOC40NiwxMi43LDE0LjMxLDIyLjksMTUuOCw5Ljg2LDEuNDQsMTguMi0xLjc3LDI1LjQtOC41LDQuMDYtMy44LDcuMDItOC4yNSw4Ljg1LTEzLjQ4LjU4LTEuNjcuODMtMy40MiwxLjI0LTUuMTIuNTgtMi40MywxLjMzLTMuMTEsMy44MS0zLjEzLDguMDctLjA3LDE2LjE1LS4wNiwyNC4yMiwwLDIuNTcuMDIsMy4xMi40NywzLjc0LDMuMTIuOCwzLjQzLDEuNjMsNi44MywzLjM3LDkuOTUsMS41NywyLjgxLDMuMzQsNS40NSw1LjQ1LDcuODcsMS4zOCwxLjU5LDMuMTUsMi43NCw0Ljg4LDMuODUsNC4xMiwyLjY1LDguNDcsNC44LDEzLjQyLDUuNTIsMi45NS40MywzLjMuOTEsMy4zMSwzLjkzLjAzLDcuOTkuMDEsMTUuOTksMCwyMy45OCwwLC4yNCwwLC40OC0uMDEuNzItLjEyLDIuNC0uNTUsMi45Ny0yLjkyLDMuMjUtMy45NS40Ny03LjY1LDEuNzItMTEuMDgsMy42Ny04LjQ2LDQuNzktMTMuNjYsMTEuOS0xNS44NiwyMS40Ni0xLjExLDQuOC0uNzcsOS4zNy4zNCwxMy45NiwxLjA5LDQuNDksMy4zMiw4LjQ2LDYuNDEsMTEuOTEsMy4zOSwzLjc4LDcuMTcsNy4wNCwxMS45Myw5LjA2LDEuOTMuODIsMy44NSwxLjU1LDUuOTIsMS44OS44Ny4xNCwxLjc0LjI3LDIuNTkuNTEsMi4xMy42MiwyLjY1LDEuMTYsMi42NiwzLjM3LjA2LDguNDcuMDYsMTYuOTUsMCwyNS40Mi0uMDIsMi40MS0uNTgsMi44OS0yLjkxLDMuMjQtMTMuMjMsMi0yMi4wNiw5LjUzLTI2LjE1LDIyLjA2LTMuNzEsMTEuMzUtLjc5LDIxLjUyLDcuMjcsMzAuMzIsNC4wOCw0LjQ1LDksNy4zMiwxNC43Myw4Ljk5LDEuMjQuMzYsMi40OC41NiwzLjc2LjczLDIuNDEuMzIsMy4yOCwxLjIsMy4zLDMuNTkuMDcsOC40Ny4wNiwxNi45NSwwLDI1LjQyLS4wMSwyLjI4LS4zMSwyLjU1LTIuNTcsMi45NC03LjM4LDEuMjYtMTMuODcsNC4yNC0xOS4wOCw5Ljc1LTMuOTIsNC4xNS02Ljc0LDguOTItNy45NCwxNC41My0uNDMsMi4wMi0xLjE1LDMuOTktMS4xLDYuMTIuMjksMTEuMjIsNC43OSwyMC4xNiwxNC4wMiwyNi43MSw0LjIsMi45OCw4LjcxLDQuOTgsMTMuODgsNS40MiwyLjA3LjE3LDIuNjIuOCwyLjc3LDIuODguMDksMS4yLjAzLDIuNC4wMywzLjYsMCw2Ljg4LDAsMTMuNzUsMCwyMC42MywwLC43Mi4wMywxLjQ0LS4wNCwyLjE2LS4xOSwxLjgyLS42OCwyLjQ0LTIuNDksMi42My0yLjQyLjI0LTQuNy45Ni02Ljk2LDEuNzMtNC4zOCwxLjUtOC4wNyw0LjAxLTExLjM3LDcuMzItMi43NiwyLjc2LTUuMSw1LjY4LTYuNzMsOS4yMi00Ljg2LDEwLjU3LTMuODYsMjAuNjcsMi41LDMwLjI3LDQuODIsNy4yNywxMS43MywxMS41OCwyMC4xLDEzLjcyLjc4LjIsMS41OC4yNCwyLjM3LjM2LDEuOTIuMjksMi40MS44NSwyLjU5LDIuODEuMDQuNC4wMy44LjAzLDEuMiwwLDcuOTEsMCwxNS44MywwLDIzLjc0LDAsLjQsMCwuOC0uMDMsMS4yLS4xNiwyLjAxLS43NSwyLjczLTIuNzgsMi45MS01LjI1LjQ3LTkuOTIsMi40My0xNC4xMiw1LjUtNi42Miw0Ljg0LTExLjE3LDExLjEyLTEyLjkyLDE5LjI2LTIuMzEsMTAuODEuOCwyMCw4LjI4LDI3LjkzLDUuMDEsNS4zMSwxMS4xNCw4LjQ1LDE4LjI4LDkuNzcsMi45Mi41NCwzLjI2Ljk2LDMuMjcsMy45OC4wMyw3Ljk5LjAzLDE1Ljk5LDAsMjMuOTgtLjAxLDIuODMtLjU3LDMuNTctMy4zOCwzLjk2LTYuMTMuODUtMTEuNDksMy4zMy0xNi4xMyw3LjM0LTUuMDIsNC4zNS04LjMsOS43OC0xMC4xLDE2LjIzLTIuMDQsNy4yNi0uODYsMTQuMTQsMi4xMSwyMC43OCwyLjAyLDQuNSw1LjI4LDguMTMsOS4xMSwxMS4yNyw0LjQ1LDMuNjUsOS42Myw1LjU2LDE1LjE2LDYuNzcsMy4xMi42OCwzLjIyLjg1LDMuMjMsMy45OC4wMiw3LjkxLjAyLDE1LjgzLDAsMjMuNzQsMCwzLjAyLS4wOCwzLjI0LTMuMDMsMy44OS0zLjkyLjg3LTcuNzEsMS45OS0xMS4yNSwzLjk2LTUuMjMsMi45MS05LjM2LDYuODYtMTIuMTgsMTIuMTktMS44NSwzLjUtMy4yLDcuMTItMy44NiwxMS4wMy0uNSwyLjk4LS45MSwzLjIzLTMuOTksMy4yNC03LjkxLjAyLTE1LjgzLDAtMjMuNzQsMC0uMjQsMC0uNDgsMC0uNzIsMC0yLjQ1LS4xMS0zLjA0LS42Mi0zLjQxLTMuMDktMS4wOS03LjIyLTQuNC0xMy4zMy05LjQ5LTE4LjQ0LTQuMzItNC4zNC05LjYxLTYuODctMTUuNjEtOC4zOS0xNS4wNy0zLjg0LTMyLjgzLDcuMy0zNi42OSwyMy4yOS0uMzIsMS4zMi0uNDIsMi42OS0uNzYsNC0uNTMsMi4wNi0xLjA0LDIuNDgtMy4xMywyLjYxLS4zMi4wMi0uNjQuMDItLjk2LjAyLTcuOTEsMC0xNS44My4wMi0yMy43NCwwLTMuMDQsMC0zLjIxLS4xNy0zLjkyLTMuMDItLjIxLS44NS0uNDMtMS43MS0uNjEtMi41Ny0xLjg0LTguNy02Ljg5LTE1LjEzLTE0LjEyLTIwLjAzLTQuNy0zLjE5LTkuOTgtNC44LTE1LjU1LTQuOTktNi43LS4yNC0xMi45LDEuNzMtMTguNTIsNS41Mi01LjYzLDMuOC05LjUzLDguOTEtMTEuOTYsMTUuMi0uODQsMi4xNy0xLjQsNC40LTEuNTQsNi43NS0uMTQsMi40My0uODcsMy4wOC0zLjMxLDMuMTMtMy41Mi4wOC03LjAzLjAyLTEwLjU1LjAyLTQuOTYsMC05LjkxLjA0LTE0Ljg3LS4wMi0yLjU1LS4wMy0yLjg4LS4yOS0zLjMyLTIuNzctLjk1LTUuMzUtMi42Ny0xMC40MS02LjA1LTE0LjcyLTQuNTMtNS43OS0xMC4xMS0xMC4xNy0xNy40MS0xMi4wNC0yLjk2LS43Ni01LjkzLTEuNDQtOC45OS0xLjEzLTYuNjQuNjgtMTIuNzYsMi42OC0xOC4wMSw3LjA0LTMuNDIsMi44NC02LjQ1LDUuOTUtOC41NCw5LjkyLTEuNzcsMy4zNi0zLjAxLDYuODctMy40MSwxMC42Ni0uMjUsMi4zOS0uNzYsMy4wMS0zLjExLDMuMDMtOC43MS4wOC0xNy40My4wOC0yNi4xNCwwLTIuMTEtLjAyLTIuNDYtLjQxLTIuNzMtMi41My0uOTctNy43LTQuNDMtMTQuMTUtOS45Ny0xOS40Ni0zLjkzLTMuNzYtOC42MS02LjM1LTEzLjkzLTcuNjQtMi4xNy0uNTMtNC4zMy0xLjA2LTYuNjEtMS4wNi02LjQzLjAxLTEyLjQ3LDEuNjUtMTcuNjQsNS4zMS03Ljc4LDUuNS0xMy4xMSwxMi44LTE0LjM0LDIyLjU5LS4zMSwyLjQ5LS42LDIuNzktMy4xOSwyLjgxLTguMzkuMDQtMTYuNzkuMDQtMjUuMTgsMC0yLjc0LS4wMi0zLjI5LS42LTMuNjQtMy4zNi0uODMtNi41Ny0zLjcxLTEyLjE1LTguMi0xNi45Ny0zLjQ0LTMuNjktNy40Mi02LjY0LTEyLjE3LTguMy0xMS45Ni00LjE4LTIyLjU1LTEuNzYtMzEuOTUsNi43NC01LjY4LDUuMTQtOC42MiwxMS41OC0xMC4wNCwxOC45LS41NSwyLjgzLS43MiwyLjk4LTMuNiwyLjk5LTguMDcuMDMtMTYuMTUuMDMtMjQuMjIsMC0zLjAxLS4wMS0zLjQ5LS4zNS0zLjk2LTMuMjktMS4zNy04LjQ3LTUuNi0xNS4zNi0xMi4yNC0yMC41MS05LjAzLTYuOTktMTkuMTEtOC45Mi0zMC4wMi00LjY4LTcuMDUsMi43NC0xMi40MSw3LjQ4LTE2LjI2LDEzLjkzLTIuMDcsMy40Ni0zLjI4LDcuMjYtMy44MSwxMS4yOC0uMzgsMi44My0uODQsMy4yNi0zLjY3LDMuMjctOC4yMy4wNC0xNi40Ny4wNC0yNC43LDAtMi44NS0uMDEtMy4zNi0uNDQtMy43Mi0zLjIyLS44Ny02LjU4LTMuODEtMTIuMjktOC4xMy0xNy4wOC00LjIyLTQuNjktOS42My03Ljg4LTE1Ljg4LTkuMzktMS4zMi0uMzItMi42NS0uNi0zLjk2LS45Ni0xLjQzLS4zOS0yLjEzLTEuMzItMi4xOC0yLjc4LS4wMS0uNC0uMDQtLjgtLjA0LTEuMiwwLTcuNjcsMC0xNS4zNSwwLTIzLjAyLDAtLjI0LDAtLjQ4LjAxLS43Mi4xMS0yLjQuNTktMywyLjk2LTMuNy43Ny0uMjMsMS41NS0uNDEsMi4zMy0uNTUsMTIuMDQtMi4xNiwyNC4wNS0xNC44NiwyNC45OS0yOC4wMi41Ny03Ljk3LTEuNTUtMTQuODktNi4yNS0yMS4yOS00LjItNS43MS05LjY3LTkuNDEtMTYuMjUtMTEuNjktMS42LS41NS0zLjI5LS42Ni00LjkyLTEuMDUtMi4zMS0uNTYtMi44My0xLjA3LTIuODQtMy40My0uMDYtOC4yMy0uMDYtMTYuNDcsMC0yNC43LjAyLTIuNDkuNDctMy4wMSwyLjk4LTMuNTUsNS4yMy0xLjExLDEwLjE1LTIuOSwxNC4zNC02LjMzLDMuOTItMy4yMSw3LjMzLTYuODcsOS44MS0xMS4zNiwxLjctMy4wOCwyLjMyLTYuNDEsMi45NC05LjgxLjY2LTMuNjMuMzMtNy4xNS0uNDItMTAuNjgtMS4yNy01Ljk4LTQuNDgtMTAuODctOC42MS0xNS4yNC01LjE3LTUuNDctMTEuNTktOC4zNS0xOC45OC05LjI4LS44My0uMS0xLjU5LjE3LTIuMzkuMTctLjY4LS41NC0uNDctMS4zMS0uNDctMi4wMS0uMDEtOS4zNS4wMS0xOC43LS4wMi0yOC4wNSwwLTEuODEuMzMtMi44NSwyLjUxLTMuMjEsNS4yLS44NiwxMC4yNS0yLjM0LDE0LjU2LTUuNjEsNi44My01LjE4LDExLjE2LTExLjc4LDEyLjI4LTIwLjQ4LDEtNy43NS0uNzQtMTQuNjgtNS4yMi0yMC45NS00LjM5LTYuMTYtMTAuMDgtMTAuNTEtMTcuNjMtMTIuMTYtMS40NC0uMzEtMi43MS0uOTgtNC4zNC0uNjgtMS41Ny4yOS0yLjE2LS45OC0yLjE1LTIuNDcuMDItMy43NiwwLTcuNTEsMC0xMS4yNywwLTUuOTksMC0xMS45OSwwLTE3Ljk4LDAtMi40MS40NC0yLjkzLDIuODUtMy4xOCwxMi40NS0xLjI4LDIwLjgxLTguMTcsMjUtMTkuNTcsNC4wNC0xMS4wMiwxLjc1LTIxLjI3LTYuMjMtMzAuMDgtMy43OC00LjE4LTguMzctNy4xMS0xMy42Ni04Ljk0LTEuODUtLjY0LTMuOC0xLjE4LTUuNzQtMS4zMS0xLjg3LS4xMy0yLjI1LS45My0yLjI0LTIuNTYuMDUtOC4wNy4wMi0xNi4xNC4wMi0yNC4yMiwwLS45Ni4wMi0xLjkyLDAtMi44OC0uMTUtNS4wMi40Ni00LjI1LDQuNTEtNC44OSw5LjQ4LTEuNSwxNi4zOS02LjUyLDIxLjI0LTE0LjYyLDIuODEtNC43LDQuMTUtOS45LDMuOTMtMTUuMy0uMzktOS40Ny00LjMxLTE3LjI4LTExLjg4LTIzLjIxLTMuNjUtMi44Ni03LjYyLTQuNzctMTIuMTktNS41Mi0xLjYzLS4yNy0zLjExLTEuMTctNC43NS0xLjU2LTEuMDctLjI1LS44NC0xLjQtLjg0LTIuMjYsMC03Ljc1LDAtMTUuNSwwLTIzLjI2LDAtMS42OC0uMDItMy4zNiwwLTUuMDMuMDMtMi4zNy42MS0zLjAzLDIuODUtMy4zMSwxMS40Ny0xLjQyLDE5LjU4LTcuNDMsMjQuMzItMTcuOTIsNS4xNi0xMS40MSwyLjEyLTI0LjQ1LTYuNDQtMzMtMy41Ni0zLjU2LTcuNzktNi4zMy0xMi43NS03LjcyLTEuOTgtLjU2LTQuMDUtLjctNi4wNC0xLjI5LTEuNC0uNDItMS45NS0xLjE3LTEuOTUtMi41Ni4wMS05LjUxLDAtMTkuMDIuMDEtMjguNTMsMC0xLjgyLjY0LTIuODcsMi43NC0zLjEyLDYuMTQtLjczLDExLjcyLTMuMDIsMTYuNC03LjEsNS41Mi00LjgxLDkuMDctMTAuNzksMTAuMTEtMTguMTMuNTMtMy43Ni43NS00LjQ0LDQuNjUtNC40MSw4Ljg3LjA1LDE3Ljc0LjA1LDI2LjYxLS4wMSwxLjk5LS4wMiwyLjkyLjU3LDMuNSwyLjYzLjczLDIuNTkuODksNS4yNywxLjk5LDcuODIsNC41NiwxMC41OCwxMi4zOSwxNi44MiwyMy43MSwxOC44OSw0LjYuODQsOS4wMS4zNCwxMy40LTEuMDJaIi8+CiAgICA8cmVjdCBjbGFzcz0iY2xzLTEiIHg9IjExNi4wOCIgeT0iMTE2LjA4IiB3aWR0aD0iNDM1LjE2IiBoZWlnaHQ9IjQzNS4xNiIvPgogIDwvZz4KPC9zdmc+`;
  
  class CandleBundler {
      emptyOptImg = `data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjZweCIgaGVpZ2h0PSIyNnB4IiB2aWV3Qm94PSIwIDAgMjYgMjYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+T3ZhbCBDb3B5IDI8L3RpdGxlPgogICAgPGcgaWQ9IldpcmVmcmFtZXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJCdWlsZC1hLUJveC0tLURlc2t0b3AiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC05NDMuMDAwMDAwLCAtNjA3LjAwMDAwMCkiIHN0cm9rZT0iI0MyQzJDMiI+CiAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtQ29weS0yIiBjeD0iOTU2IiBjeT0iNjIwIiByPSIxMi41Ij48L2NpcmNsZT4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==`
      chosenOpt = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjZweCIgaGVpZ2h0PSIyNnB4IiB2aWV3Qm94PSIwIDAgMjYgMjYiIHZlcnNpb249IjEuMSIgc3R5bGU9ImNvbG9yOiBibGFjayAhaW1wb3J0YW50OyI+CiAgICA8dGl0bGU+R3JvdXAgNDwvdGl0bGU+CiAgICA8ZyBpZD0iV2lyZWZyYW1lcyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkJ1aWxkLWEtQm94LS0tRGVza3RvcCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk0My4wMDAwMDAsIC01MzAuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC00IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5NDMuMDAwMDAwLCA1MzAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsIiBzdHJva2U9IiNDMkMyQzIiIGN4PSIxMyIgY3k9IjEzIiByPSIxMi41Ii8+CiAgICAgICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsIiBmaWxsPSJibGFjayIgY3g9IjEzIiBjeT0iMTMiIHI9IjgiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+`
      
      
      constructor() {
          this.selectedPack = {pNum:2, price:'$52'};
          this.selectedProducts = [];
          // Initially, make the first button active
          this.setSelectedPack();
      }
  
      // Update cart button text
      updateCartButtonText(text) {
        const buttons = [document.querySelector("#add-bundler-to-cart"), document.getElementById("bundler-disktop-addCart")];
        buttons.forEach(btn => {
          if (btn) {
            btn.innerHTML = text;
          }
        });
      }
  
      // Enable or disable cart buttons
      setCartButtonsState(disabled) {
        const buttons = [document.querySelector("#add-bundler-to-cart"), document.getElementById("bundler-disktop-addCart")];
        buttons.forEach(btn => {
          if (btn) {
            btn.disabled = disabled;
          }
        });
      }
  
      getSelectedPack() {
          return this.selectedPack.pNum;
      }
      
      updatePlaceHolders(){
        const boxContainer = document.querySelector('.disktop-box');
        boxContainer.innerHTML = '';
        for(let i=0; i < this.getSelectedPack(); i++){
          const product = this.selectedProducts[i]; 
          // Create a new `.box-product` element
          const productElement = document.createElement('div');
          productElement.classList.add('box-product');
          // Create an image element for the product image
          let imgElement = null;
          if(product){
            imgElement= document.querySelector(`[id="${product.id}"] img`).cloneNode(true);
            imgElement.classList = [];  
            imgElement.classList.add('box-product-img');
            imgElement.classList.add('box-product-img-empty');  
          }else{
            imgElement = document.createElement("img");
            imgElement.src = disktopPlaceHolder; 
          }
         
          // Append the product image element to the product element
          productElement.appendChild(imgElement);
         
          // Append the product element to the container
          boxContainer.appendChild(productElement);
          if(product){
            // Create an image element for the "remove product" button
            const removeButton = document.createElement('img');
            removeButton.classList.add('btn-remove'); 
            removeButton.setAttribute('role', 'button');
            removeButton.alt = 'remove product';
            removeButton.src = boxProductX;
            removeButton.setAttribute('data-p-id', product.id);
            // Append the "remove product" button element next to the product image element
            imgElement.parentNode.insertBefore(removeButton, imgElement.nextSibling);
          }
        }
      }
      
      setSelectedPack(packBtn){
          const radioButtons = document.querySelectorAll(".radio-group button");
          packBtn = packBtn ? packBtn : radioButtons[0];
          const candleNum = this.getCandleNum(packBtn);
          const packPrice = this.getPackPrice(packBtn);
          
          if(!candleNum || ![2, 4, 6, 8].includes(candleNum)) {
              console.error('Invalid candle number:', candleNum);
              return;
          }
          
          this.updateNumberOfCandles(candleNum);
        
          if(this.getProductsNumber() > candleNum){
            this.selectedProducts = this.selectedProducts.slice(0, candleNum);
            this.updateBoxProducts();
          }
          
          radioButtons.forEach((btn) =>{
              btn.classList.remove("is-active");
              btn.querySelector("img").src = this.emptyOptImg;
          });
          
          // Update the selected pack values
          this.selectedPack = {
            pNum: candleNum,
            price: packPrice
          };
          
          packBtn.classList.add("is-active");
          packBtn.querySelector("img").src = this.chosenOpt;
          this.updateCandlesBtn(this.selectedPack.pNum - this.getProductsNumber(), packPrice);
          
          //disktop logic
          var placeHodlers = document.querySelectorAll('.disktop-box .box-product'); 
          if (placeHodlers && placeHodlers.length) {
            placeHodlers.forEach(function(element) {
              element.style.display = "inherit";
            });  
            var selectedPlaceHolders = Array.from(placeHodlers).slice(this.selectedPack.pNum, 8);
            selectedPlaceHolders.forEach(function(element) {
              element.style.display = "none";
            });
          }
          this.updatePlaceHolders();
      }
  
      getSelectedProducts() {
          return this.selectedProducts;
      }
  
      addProduct(product) {
          if(this.isBundled()) 
              console.log("Pack is already full. Cannot add more products.");
          if(this.selectedProducts.length < this.selectedPack.pNum){
              this.selectedProducts = [...this.selectedProducts, product];
              this.updateCandlesBtn(this.selectedPack.pNum - this.getProductsNumber(), this.selectedPack.price); 
              this.updateBoxProducts();
              this.updatePlaceHolders();
          }
      }
  
      removeProduct(pId) {
          const pIndex = this.selectedProducts.findIndex((p) => p.id == pId);

          if (pIndex !== -1) {
            this.selectedProducts.splice(pIndex, 1);
            this.updateCandlesBtn(this.selectedPack.pNum - this.getProductsNumber());
            this.updateBoxProducts();
            this.updatePlaceHolders(); 
          } 
      }
  
      getProductsNumber() {
          return this.selectedProducts.length;
      }
  
      isBundled() {
          return this.selectedPack.pNum === this.selectedProducts.length;
      }
  
      getCandleNum(btn){
          const label = btn.querySelector(".radio-btn-label");
          if (!label) return null;
          
          const buttonText = label.textContent.trim();
          const numberMatch = buttonText.match(/\d+/);
          return numberMatch ? parseInt(numberMatch[0]) : null;
      }
      
      getPackPrice(btn){
        const spanPrice = btn.querySelector(".radio-btn-price span:last-child");
        // Make sure we're getting the actual price span, not the strike-through one
        if (!spanPrice) {
          console.error("Price span not found in button:", btn.textContent);
          return "$0";
        }
        return spanPrice.textContent.trim(); 
      }
  
      updateNumberOfCandles(number) {
          const numberOfCandlesParagraph = document.querySelector(".box-cart-header p");
          const numberOfCandlesBtn = document.querySelector(".footer button");
          numberOfCandlesParagraph.textContent = `Select your ${number} travel candles.`;
          numberOfCandlesBtn.textContent = `PICK ${number} MORE CANDLES`;
      }
      
      updateCandlesBtn(pNum, packPrice=''){
        // Update the buttons based on the number of products selected
        if(pNum == 0){
          this.updateCartButtonText(`ADD TO CART - ${packPrice}`);
          this.setCartButtonsState(false);
        }
        else{
          this.updateCartButtonText(`PICK ${pNum} MORE CANDLES`);
          this.setCartButtonsState(true);
        }
      }
      
      updateBoxProducts(){
        const boxContainer = document.querySelector('.box');
        boxContainer.innerHTML = '';  
        this.selectedProducts.forEach(product => {
          // Create a new `.box-product` element
          const productElement = document.createElement('div');
          productElement.classList.add('box-product');
        
          // Create an image element for the product image
          const imgElement = document.querySelector(`[id="${product.id}"] img`).cloneNode(true);
          imgElement.classList = [];  
          imgElement.classList.add('box-product-img');
        
          // Create an image element for the "remove product" button
          const removeButton = document.createElement('img');
          removeButton.classList.add('btn-remove');
          removeButton.setAttribute('role', 'button');
          removeButton.alt = 'remove product';
          removeButton.src = boxProductX;
          removeButton.setAttribute('data-p-id', product.id);
          
          // Append the product image element to the product element
          productElement.appendChild(imgElement);
        
          // Append the "remove product" button element next to the product image element
          imgElement.parentNode.insertBefore(removeButton, imgElement.nextSibling);
        
          // Append the product element to the container
          boxContainer.appendChild(productElement);
        });
      }

      addtoCart(){
        const packIds = {"2":51495102087441,"4":51495105822993, "6":51495106412817, "8":51495110181137};
        
        // Get the pack ID based on selection
        const packId = packIds[this.selectedPack.pNum.toString()];
        
        if (!packId) {
          console.error("Invalid pack ID for selected pack:", this.selectedPack);
          return;
        }
        
        // Create properties for the bundle
        const pProps = this.selectedProducts.reduce((acc, p, index) => {
            // Use a more descriptive format for better display in cart
            acc[`Item ${index+1}`] = p.title;
            // Store image data for display in cart
            acc["_"+index+":"+btoa(p.featured_image || p.images[0])] = p.title;
            return acc;
          }, {});
        
        // Add bundle type property to help with identification in cart
        pProps['Bundle Type'] = `${this.selectedPack.pNum}-Pack Bundle`;
        pProps['Bundle Price'] = this.selectedPack.price;
        
        // Create FormData for the fetch request
        const formData = new FormData();
        formData.append('id', packId);
        formData.append('quantity', 1);
        
        // Important: include the same sections that the theme expects
        formData.append('sections', 'cart-items,cart-footer,cart-item-count,cart-live-region');
        formData.append('sections_url', window.location.pathname);
        
        // Add all properties to formData
        for (const [key, value] of Object.entries(pProps)) {
          formData.append(`properties[${key}]`, value);
        }
        
        // Setup fetch configuration
        const config = {
          method: 'POST',
          headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'Accept': 'application/json'
          },
          body: formData
        };
        
        // Make the fetch request to add to cart
        fetch(`${window.Shopify.routes.root}cart/add.js`, config)
          .then(response => response.json())
          .then(data => {
            if (data.status) {
              console.error(data.description || data.message || 'Error adding bundle to cart');
            } else {
              // Use the same event format the theme expects
              document.body.dispatchEvent(
                new CustomEvent('shapes:cart:afteradditem', {
                  bubbles: true,
                  detail: {
                    response: {
                      sections: data.sections,
                      key: data.key,
                      variant_id: data.variant_id
                    },
                    sourceId: 'bundle-builder'
                  }
                })
              );
              
              // Also dispatch the modalcart event that we're listening for
              document.dispatchEvent(
                new CustomEvent('shapes:modalcart:afteradditem', {
                  bubbles: true
                })
              );
            }
          })
          .catch(error => {
            console.error('Error adding bundle to cart:', error);
          });
      }
  }
  
  document.addEventListener("DOMContentLoaded", function(){ 
    const candleBundler = new CandleBundler();   
    const radioButtons = document.querySelectorAll(".radio-group button");
    radioButtons.forEach(btn => btn.addEventListener("click", (e) => {
      candleBundler.setSelectedPack(btn); 
    })); 
    const products = document.querySelectorAll(".products .product");
    products.forEach((productDiv) => {
          productDiv.addEventListener("click", function() {
            const productData = JSON.parse(decodeURIComponent(productDiv.getAttribute("data-product")));
            candleBundler.addProduct(productData); 
          });
    }); 
    const addBundlerToCartBtn = document.querySelector("#add-bundler-to-cart");
    addBundlerToCartBtn.addEventListener("click", (e) => {
      candleBundler.addtoCart();
    });
    const disktopAddTocartBtn = document.querySelector("#bundler-disktop-addCart");
    disktopAddTocartBtn.addEventListener("click", (e) => {
      candleBundler.addtoCart(); 
    }); 
    const box_containers = [document.querySelector('.footer .box'),document.querySelector('.disktop-box')];
    box_containers.forEach((box_container) => {
        box_container.addEventListener('click', function (event) { 
          if (event.target.classList.contains('btn-remove')){ 
            const pId = event.target.getAttribute("data-p-id");
            candleBundler.removeProduct(pId);
          }
        }); 
    });
  });
  
{% endjavascript %}
